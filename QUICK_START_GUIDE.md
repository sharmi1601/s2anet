# Quick Start Guide - S2A-Net Training with 12 Classes

## Your Current Setup
- ✅ S2A-Net codebase with RTX 4070 compatibility fixes
- ✅ `data/base_training/` folder with 12-class dataset (1024x1024 images)
- ✅ Conda environment: `s2anet`
- ❌ MMCV installation needed

## Quick Setup (Windows)

### 1. Activate Environment
```cmd
conda activate s2anet
```

### 2. Install MMCV
```cmd
pip install mmcv-full>=1.0.0 -f https://download.openmmlab.com/mmcv/dist/cu121/torch1.12/index.html
```

### 3. Install Other Dependencies
```cmd
pip install -r requirements.txt
```

### 4. Compile S2A-Net
```cmd
set TORCH_CUDA_ARCH_LIST=6.0;6.1;7.0;7.5;8.0;8.6;8.9+PTX
set FORCE_CUDA=1
set MMCV_WITH_OPS=1
python setup.py develop
```

### 5. Compile DOTA Devkit
```cmd
cd DOTA_devkit\polyiou
swig -c++ -python csrc\polyiou.i
python setup.py build_ext --inplace
cd ..\..
```

### 6. Prepare Your Dataset
```cmd
python prepare_base_training_dataset.py --create_sample
```
This will create the required directory structure. Then replace the sample data with your actual annotations.

### 7. Test Setup
```cmd
python test_training_setup.py
```

### 8. Start Training
```cmd
python tools\train.py configs\dota\s2anet_r50_fpn_1x_dota_12_classes.py
```

## Dataset Structure Expected
```
data/base_training/
├── images/                    # Your 1024x1024 images
│   ├── image1.jpg
│   ├── image2.jpg
│   └── ...
└── annotations/               # Generated by prepare script
    ├── train.pkl
    ├── val.pkl
    └── test.pkl
```

## Training Configuration
- **Model**: ResNet-50 + FPN + S²A-Net head
- **Classes**: 12 base classes + background (13 total)
- **Image Size**: 1024×1024
- **Batch Size**: 2 per GPU (adjustable)
- **Epochs**: 12
- **Learning Rate**: 0.01 (drops at epochs 8 & 11)
- **Optimizer**: SGD (momentum=0.9, weight_decay=1e-4)

## Monitoring Training
- **Logs**: `work_dirs/s2anet_r50_fpn_1x_dota_12_classes/`
- **Checkpoints**: Saved every epoch
- **Expected Time**: 12-24 hours on RTX 4070

## Troubleshooting

### If MMCV installation fails:
```cmd
pip install mmcv-full==1.7.1 -f https://download.openmmlab.com/mmcv/dist/cu121/torch1.12/index.html
```

### If compilation fails:
- Check CUDA version: `nvcc --version`
- Ensure PyTorch CUDA version matches: `python -c "import torch; print(torch.version.cuda)"`

### If training fails:
- Check dataset format with test script
- Verify GPU memory: reduce `imgs_per_gpu` if needed
- Check annotation format matches expected structure

## Next Steps After Training
1. Save the trained model checkpoint
2. Prepare few-shot datasets with novel classes
3. Implement few-shot fine-tuning pipeline
4. Evaluate on test set

## Quick Commands Summary
```cmd
# Setup
conda activate s2anet
pip install mmcv-full>=1.0.0 -f https://download.openmmlab.com/mmcv/dist/cu121/torch1.12/index.html
pip install -r requirements.txt
python setup.py develop

# Dataset
python prepare_base_training_dataset.py --create_sample

# Test & Train
python test_training_setup.py
python tools\train.py configs\dota\s2anet_r50_fpn_1x_dota_12_classes.py
```

